<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Weather App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

    <style>
        .custom-nav-link {
            padding-top: calc(0.5rem * 1.5) !important;
            padding-bottom: calc(0.5rem * 1.5) !important;
            padding-left: calc(1rem * 1.5) !important;
            padding-right: calc(1rem * 1.5) !important;
        }

        .inline-form {
            display: flex;
            align-items: center; /* Center items vertically */
            flex-wrap: nowrap;    /* Prevent wrapping */
        }

        .inline-form .form-label {
            margin-right: 10px;
            flex-basis: auto;      /* Allow label to size based on content */
            max-width: none;        /* Remove max-width restriction */
            white-space: nowrap; /* Prevent label from wrapping */
        }

        .inline-form .form-control {
            flex-grow: 1;          /* Allow input to take up remaining space */
            min-width: 0;          /* Allow input to shrink if needed */
        }

        .inline-form .btn {
            margin-left: 10px;
            white-space: nowrap;  /* Prevent button text from wrapping */
        }

        /* Ensure responsiveness on smaller screens */
        @media (max-width: 768px) {
            .inline-form {
                flex-direction: column; /* Stack items vertically on small screens */
                align-items: stretch;   /* Make items stretch to fill width */
            }

            .inline-form .form-label,
            .inline-form .form-control,
            .inline-form .btn {
                margin-bottom: 5px;   /* Add some space between stacked items */
                margin-left: 0;        /* Remove left margin on button */
                margin-right: 0;
                max-width: none;       /* Let label take full width when stacked */
            }
        }

    </style>

</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <a class="navbar-brand" th:href="@{/}">Weather APP</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto"></ul>
            <div class="d-flex">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active bg-danger custom-nav-link" aria-current="page" th:href="@{/logout}">LOG
                            OUT</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</nav>

<br/>

<div class="container">
    <h1>Weather App</h1>

    <!--  Error Message  -->
    <div th:if="${errorMessage}" class="alert alert-danger">
        <span th:text="${errorMessage}"></span>
    </div>

    <!-- Form to get weather by city name -->
    <form th:action="@{/getWeatherByCity}" method="post">
        <div class="mb-3 inline-form">
            <label for="city" class="form-label">Enter City Name:</label>
            <input type="text" class="form-control" id="city" name="city" required>
            <button type="submit" class="btn btn-primary">Get Weather</button>
        </div>
    </form>
    <hr/>

    <!-- Display searched weather information -->
    <div th:if="${weather != null}">
        <h2>Weather in <span th:text="${city} + ' (' + ${weather.country} + ')'"></span>:</h2>
        <table class="table table-bordered">
            <tbody>
            <tr>
                <th>Temperature</th>
                <td><span th:text="${#numbers.formatDecimal(weather.temperature,1,1)}"></span> 째C</td>
                <th>Description</th>
                <td><span th:text="${weather.description}"></span></td>

            </tr>
            <tr>
                <th>Pressure</th>
                <td><span th:text="${weather.pressure}"></span> hPa</td>
                <th>Humidity</th>
                <td><span th:text="${weather.humidity}"></span>%</td>
            </tr>
            <tr>
                <th>Wind Speed</th>
                <td><span th:text="${#numbers.formatDecimal(weather.windSpeed,1,1)}"></span> m/s</td>
                <th>Wind Direction</th>
                <td><span th:text="${weather.windDirection}"></span>째</td>
            </tr>
            <tr>
                <th>Cloudiness</th>
                <td><span th:text="${weather.cloudiness}"></span>%</td>
                <th>Day Length</th>
                <td><span th:text="${weather.dayLength}"></span></td>
            </tr>
            <tr>
                <th>Sunrise</th>
                <td><span th:text="${weather.sunrise}"></span></td>
                <th>Sunset</th>
                <td><span th:text="${weather.sunset}"></span></td>
            </tr>
            </tbody>
        </table>
        <hr/>
    </div>

    <!-- Add Location Form -->
    <form th:action="@{/addLocation}" method="post">
        <div class="mb-3 inline-form">
            <label for="cityToAdd" class="form-label">Add City to List:</label>
            <input type="text" class="form-control" id="cityToAdd" name="city" required>
            <button type="submit" class="btn btn-success">Add Location</button>
        </div>
    </form>
    <hr/>

<!--    &lt;!&ndash; Display saved locations &ndash;&gt;-->
<!--    <h2>Saved Locations:</h2>-->
<!--    <div th:if="${locations != null and !locations.isEmpty()}">-->
<!--        <div th:each="location : ${locations}" class="card mb-3">-->
<!--            <div class="card-body">-->
<!--                <h5 class="card-title" th:text="${location.name}"></h5>-->
<!--                <p class="card-text">Temperature: <span th:text="${location.temperature}"></span> 째C</p>-->
<!--                <form th:action="@{/removeLocation}" method="post"-->
<!--                      onsubmit="return confirm('Are you sure you want to remove this location?');">-->
<!--                    <input type="hidden" name="locationId" th:value="${location.locationId}">-->
<!--                    <button type="submit" class="btn btn-danger">Remove</button>-->
<!--                </form>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--    <div th:unless="${locations != null and !locations.isEmpty()}">-->
<!--        <p>No locations added yet.</p>-->
<!--    </div>-->

    <!-- Display saved locations in a table -->
    <h2>Saved Locations:</h2>
    <div th:if="${locations != null and !locations.isEmpty()}">
        <table class="table table-striped">
            <thead>
            <tr>
                <th>Name</th>
                <th>Description</th>
                <th>Temperature (째C)</th>
                <th>Wind Speed (m/s)</th>
                <th>Humidity (%)</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="location : ${locations}">
                <td th:text="${location.name}"></td>
                <td th:text="${location.description}"></td>
                <td th:text="${location.temperature}"></td>
                <td th:text="${location.windSpeed}"></td>
                <td th:text="${location.humidity}"></td>
                <td>
                    <form th:action="@{/removeLocation}" method="post"
                          onsubmit="return confirm('Are you sure you want to remove this location?');">
                        <input type="hidden" name="locationId" th:value="${location.locationId}">
                        <button type="submit" class="btn btn-danger btn-sm">Remove</button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <div th:unless="${locations != null and !locations.isEmpty()}">
        <p>No saved locations.</p>
    </div>


</div>

</body>
</html>
